(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0daac9"],{"6d38":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:{callback:e.initialize},expression:"{callback: initialize}"}],staticClass:"timelineElement"},[e.ok?n("span",[e.negative?n("div",{staticClass:"assertionTimelineIcon negative"},[n("i",{staticClass:"fa fa-times"})]):e.badged?n("div",{staticClass:"assertionTimelineIcon badged"},[n("i",{staticClass:"fa fa-shield-alt"})]):n("div",{staticClass:"assertionTimelineIcon positive"},[n("i",{staticClass:"fa fa-check"})]),n("div",{staticClass:"content"},[n("div",{staticClass:"timelineElementTextContainer"},[n("div",[n("strong",{staticClass:"agentName"},[e._v(e._s(e.agent))]),e._v(" claimed "),n("strong",{staticClass:"subjectName"},[e._v(e._s(e.subject)+" ")]),e.negative?n("span",{staticClass:"negativeClaim"},[e._v("could not")]):n("span",{staticClass:"positiveClaim"},[e._v("could")]),e._v(" demonstrate "),n("a",{staticClass:"competencyLink",attrs:{href:"#",title:e.assertion.competency},on:{click:e.gotoCompetency}},[e._v(" "+e._s(e.competencyName)+" "),e.frameworkName?n("span",[e._v(" in the subject area "+e._s(e.frameworkName))]):e._e()]),e.evidenceText?n("span",{staticClass:"evidenceText"},[e._v(" because they "),e._l(e.evidenceText,(function(t,i){return n("span",{key:i},[0!=i?n("span",[e._v(" and they ")]):e._e(),t.url?n("a",{attrs:{href:t.url,target:"_blank"}},[e._v(" "+e._s(t.text))]):n("span",[e._v(" "+e._s(t.text))])])}))],2):e._e(),e.badged?n("span",{staticClass:"badge"},[e._v(" and has issued a "),n("a",{attrs:{target:"_blank",href:e.badgeUrl}},[e._v(" badge")])]):e._e(),e._v(". ")]),n("div",[n("div",{staticClass:"button is-text",style:e.invisible,attrs:{title:"Delete this claim."},on:{click:e.deleteMe}},[n("i",{staticClass:"fas fa-times"})])])]),n("div",[n("small",[e._v(e._s(e.competencyDescription))]),e.timestamp?n("div",{staticClass:"time"},[n("strong",[e._v(e._s(e.timeAgo))])]):e._e()])])]):n("div",{staticClass:"time"},[n("i",{staticClass:"mdi mdi-spin mdi-loading"})])])},s=[],r=(n("b0c0"),n("ac1f"),n("3ca3"),n("841c"),n("ddb0"),n("96cf"),n("c964")),a=n("872c"),o={name:"TimelineElement",mixins:[a["a"]],props:{uri:String},data:function(){return{assertion:null,subject:null,subjectPk:null,agentPk:null,agent:null,timestamp:null,expiry:null,competency:null,negative:null,agentPerson:null,subjectPerson:null,evidence:null,evidenceExplanation:null}},computed:{timeAgo:function(){return null===this.timestamp?null:this.$moment(this.timestamp).fromNow()},assertions:function(){return this.$store.getters["editor/assertions"]},ok:function(){return null!=this.subject&&(null!=this.agent&&null!=this.competency)},competencyName:function(){return null==this.competency?null:this.competency.getName()},frameworkName:function(){return null==this.framework?null:this.framework.getName()},competencyDescription:function(){return null==this.competency?null:this.competency.getDescription()},fingerprintUrlAgent:function(){return null==this.agentPerson?null:null!=this.agentPerson.email?"https://www.gravatar.com/avatar/"+EcCrypto.md5(this.agentPerson.email.toLowerCase())+"?s=44":null},fingerprintUrlSubject:function(){return null==this.subjectPerson?null:null!=this.subjectPerson.email?"https://www.gravatar.com/avatar/"+EcCrypto.md5(this.subjectPerson.email.toLowerCase())+"?s=44":null},fingerprintAgent:function(){return null==this.agentPerson?null:this.agentPerson.getGuid()},fingerprintSubject:function(){return null==this.subjectPerson?null:this.subjectPerson.getGuid()},mine:function(){if(null==this.uri)return null;var e=this.assertion;return null!==e?null===e.owner||0===e.owner.length||e.hasOwner(EcIdentityManager.default.ids[0].ppk.toPk()):null},evidenceText:function(){return this.evidenceExplanation},badged:function(){return null!=this.assertion&&this.assertion.hasReader(this.$store.getters["editor/badgePk"])},badgeUrl:function(){return null!=this.assertion&&this.assertion.hasReader(this.$store.getters["editor/badgePk"])?EcRemote.urlAppend(repo.selectedServer,"badge/assertion/")+this.assertion.getGuid():""},invisible:function(){return this.mine?{visibility:"visible"}:{visibility:"hidden"}}},destroyed:function(){clearInterval(this.invl)},watch:{evidence:function(e,t){var n=this;if(this.evidenceExplanation=null,null!=this.evidence&&this.evidence.length>0){var i=this.evidence.length;this.$store.dispatch("editor/computeBecause",this.evidence).then((function(e){n.$nextTick((function(){i===n.evidence.length&&(n.evidenceExplanation=e)}))}))}}},methods:{initialize:function(e,t){if(this.isVisible=e,e){if(this.once)return;this.once=!0,this.getAssertion(e,t)}},getAssertion:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var i,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.delegateYield(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,EcAssertion.get(s.uri);case 2:if(t=e.sent,s.assertion=t,null===t.subject?s.subject="nobody":(t.getSubjectName(window.repo).then((function(e){s.subject=e})),t.getSubjectAsync((function(e){s.subjectPk=e.toPem(),s.getSubject()}),appError)),null===t.agent?s.agent="nobody":t.getAgentName(window.repo).then((function(e){s.agent=e})),t.getAgentAsync((function(e){s.agentPk=e.toPem(),s.getAgent()}),appError),null!=t.assertionDate&&t.getAssertionDateAsync((function(e){s.timestamp=e}),appError),null!=t.expirationDate&&t.getExpirationDateAsync((function(e){s.expiry=e}),appError),null!=t.negative?t.getNegativeAsync((function(e){s.negative=e}),appError):s.negative=!1,null!=t.evidence)for(i=0;i<t.getEvidenceCount();i++)(function(e){t.getEvidenceAsync(e,(function(e){null==s.evidence&&(s.evidence=[]),s.evidence.push(e),s.evidenceExplanation=null}),appError)})(i);null!=t.framework&&EcFramework.get(t.framework,(function(e){s.framework=e}),appError),EcCompetency.get(t.competency,(function(e){s.competency=e}),(function(){for(var e=0;e<s.assertions.length;e++)while(s.assertions[e].id===t.id)s.$store.commit("editor/removeAssertionAtIndex",e)}));case 13:case"end":return e.stop()}}),e)}))(),"t0",2);case 2:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),gotoCompetency:function(){var e=this;EcFramework.search(window.repo,'competency:"'+this.assertion.competency+'"').then((function(t){t.length>0&&(e.$store.commit("editor/framework",t[0]),e.$store.commit("editor/clearFrameworkCommentData"),e.$store.commit("app/setCanViewComments",e.canViewCommentsCurrentFramework()),e.$store.commit("app/setCanAddComments",e.canAddCommentsCurrentFramework()),e.$router.push({name:"framework",params:{frameworkId:t[0].id}}))})).catch(appError)},getAgent:function(){var e=this;this.agentPerson=null;var t=this;EcPerson.search(window.repo,EcPk.fromPem(t.agentPk).fingerprint(),(function(n){if(0===n.length){var i=EcPk.fromPem(t.agentPk),s=new EcPerson;s.assignId(window.repo.selectedServer,i.fingerprint()),s.addOwner(i),null===e.displayName?s.name="Unknown Person.":s.name=e.displayName,e.agentPerson=s}else e.agentPerson=n[0]}),(function(n){var i=EcPk.fromPem(t.agentPk),s=new EcPerson;s.assignId(window.repo.selectedServer,i.fingerprint()),s.addOwner(i),null===e.displayName?s.name="Unknown Person.":s.name=e.displayName,e.agentPerson=s}))},getSubject:function(){var e=this;this.agentPerson=null;var t=this;EcPerson.search(window.repo,EcPk.fromPem(t.subjectPk).fingerprint(),(function(n){if(0===n.length){var i=EcPk.fromPem(t.subjectPk),s=new EcPerson;s.assignId(window.repo.selectedServer,i.fingerprint()),s.addOwner(i),null===e.displayName?s.name="Unknown Person.":s.name=e.displayName,e.subjectPerson=s}else e.subjectPerson=n[0]}),(function(n){var i=EcPk.fromPem(t.subjectPk),s=new EcPerson;s.assignId(window.repo.selectedServer,i.fingerprint()),s.addOwner(i),null===e.displayName?s.name="Unknown Person.":s.name=e.displayName,e.subjectPerson=s}))},deleteMe:function(){var e=this;window.confirm("Are you sure you want to delete this assertion?")&&EcRepository.get(this.uri,(function(t){EcRepository._delete(t,(function(){e.$store.commit("editor/removeAssertion",t)}),appError)}))}}},c=o,l=n("2877"),u=Object(l["a"])(c,i,s,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0daac9.b1d087ed.js.map