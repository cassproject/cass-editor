(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3561f686","chunk-2d0dab46","chunk-83807946","chunk-83807946","chunk-2d0dab46"],{"0813":function(e,t,n){},"2f8b":function(e,t,n){},"54a0":function(e,t,n){"use strict";n("0813")},"6d79":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("ac1f"),n("841c"),n("d3b7"),n("25f0"),n("caad"),n("2532"),n("14d9");var o=n("c7eb"),r=n("b85c"),a=n("1da1"),s={name:"cassUtil",data:function(){return{}},methods:{getOrganizationByEcPk:function(e,t,n){var s=e.toPem(),i={size:1e4};EcOrganization.search(window.repo,"",function(){var e=Object(a["a"])(Object(o["a"])().mark((function e(a){var i,c,m,d,l,u,f;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=Object(r["a"])(a),e.prev=1,i.s();case 3:if((c=i.n()).done){e.next=34;break}return m=c.value,e.prev=5,e.next=8,m.getOrgKeys();case 8:d=e.sent,l=Object(r["a"])(d),e.prev=10,l.s();case 12:if((u=l.n()).done){e.next=19;break}if(f=u.value,!f||!f.toPk().toPem().equals(s)){e.next=17;break}return t(m),e.abrupt("return");case 17:e.next=12;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e["catch"](10),l.e(e.t0);case 24:return e.prev=24,l.f(),e.finish(24);case 27:e.next=32;break;case 29:e.prev=29,e.t1=e["catch"](5),n(e.t1.toString());case 32:e.next=3;break;case 34:e.next=39;break;case 36:e.prev=36,e.t2=e["catch"](1),i.e(e.t2);case 39:return e.prev=39,i.f(),e.finish(39);case 42:t(null);case 43:case"end":return e.stop()}}),e,null,[[1,36,39,42],[5,29],[10,21,24,27]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){n(e)}),i)},getOrganizationEcPk:function(e){return Object(a["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getCurrentOrgKey();case 3:return t.abrupt("return",t.sent.toPk());case 6:return t.prev=6,t.t0=t["catch"](0),t.abrupt("return",null);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},getPersonEcPk:function(e){var t=this.generateProbablePersonFingerprintFromShortId(e.shortId());if(e.owner){var n,o=Object(r["a"])(e.owner);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=EcPk.fromPem(a);if(t.equals(s.fingerprint()))return s}}catch(i){o.e(i)}finally{o.f()}}return null},addAllOwnersFromObjectToObject:function(e,t){if(e&&e.owner){var n,o=Object(r["a"])(e.owner);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=EcPk.fromPem(a);t.addOwner(s)}}catch(i){o.e(i)}finally{o.f()}}},setDefaultBrowserConfigId:function(e){localStorage.setItem("cassAuthoringToolDefaultBrowserConfigId",e)},removeDefaultBrowserConfig:function(){localStorage.removeItem("cassAuthoringToolDefaultBrowserConfigId")},getDefaultBrowserConfigId:function(){return localStorage.getItem("cassAuthoringToolDefaultBrowserConfigId")},getBooleanValue:function(e){return"boolean"===typeof e?e:"string"===typeof e&&!!e.equalsIgnoreCase("true")},addAllIdentityPksAsOwners:function(e){if(EcIdentityManager&&EcIdentityManager.default.ids&&EcIdentityManager.default.ids.length>0)for(var t=0;t<EcIdentityManager.default.ids.length;t++)e.addOwner(EcIdentityManager.default.ids[t].ppk.toPk())},isObjectOwnerless:function(e){return!e.owner||0===e.owner.length},doesAnyIdentityOwnObject:function(e){return!!this.isAdmin()||(null==e.canEditAny||e.canEditAny(EcIdentityManager.default.getMyPks()))},canEditAny:function(e){return!!this.isAdmin()||(null==e.canEditAny||e.canEditAny(EcIdentityManager.default.getMyPks()))},isAdmin:function(){return EcIdentityManager.default.ids.length>0&&null!=window.repo.adminKeys&&window.repo.adminKeys.length>0&&window.repo.adminKeys[0]===EcIdentityManager.default.ids[0].ppk.toPk().toPem()},generateProbablePersonFingerprintFromShortId:function(e){return e.substring(e.lastIndexOf("/")+1)},isPersonIdAnObjectOwner:function(e,t){if(!t.owner||0===t.owner.length)return!1;var n,o=this.generateProbablePersonFingerprintFromShortId(e),a=Object(r["a"])(t.owner);try{for(a.s();!(n=a.n()).done;){var s=n.value,i=EcPk.fromPem(s).fingerprint();if(i.equals(o))return!0}}catch(c){a.e(c)}finally{a.f()}return!1},isPersonIdAnObjectReader:function(e,t){if(!t.reader||0===t.reader.length)return!1;var n,o=this.generateProbablePersonFingerprintFromShortId(e),a=Object(r["a"])(t.reader);try{for(a.s();!(n=a.n()).done;){var s=n.value,i=EcPk.fromPem(s).fingerprint();if(i.equals(o))return!0}}catch(c){a.e(c)}finally{a.f()}return!1},areAnyIdentitiesThisPerson:function(e){var t=e.getFingerprint();if(EcIdentityManager&&EcIdentityManager.default.ids&&EcIdentityManager.default.ids.length>0)for(var n=0;n<EcIdentityManager.default.ids.length;n++)if(EcIdentityManager.default.ids[n].ppk.toPk().fingerprint().equals(t))return!0;return!1},isPersonalIdentityAnObjectOwner:function(e){if(this.isAdmin())return!0;if(!e.owner||0===e.owner.length)return!1;var t=this.getPersonalIdentityPk().toPem();return e.owner.includes(t)},getPersonalIdentityPk:function(){return EcIdentityManager&&EcIdentityManager.default.ids&&EcIdentityManager.default.ids.length>0?EcIdentityManager.default.ids[0].ppk.toPk():null},buildEcAlignmentsFromRemoteLinkedData:function(e){var t,n=[],o=Object(r["a"])(e);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=new EcAlignment;s.copyFrom(a),n.push(s)}}catch(i){o.e(i)}finally{o.f()}return n}},computed:{amLoggedIn:function(){return!!(EcIdentityManager&&EcIdentityManager.default.ids&&EcIdentityManager.default.ids.length>0)}}}},"840c":function(e,t,n){"use strict";n("2f8b")},"8a30":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e._self._c;return t("modal-template",{attrs:{type:"info",active:!0},on:{close:e.closeModal}},[t("template",{slot:"modal-header"},[e.isCommentNew||e.isCommentReply?t("span",[e._v("New Comment")]):e._e(),e.isCommentEdit?t("span",[e._v("Edit Comment")]):e._e()]),t("template",{slot:"modal-body"},[e.isCommentNew?t("span",{staticClass:"comment-modal__details__header"},[e._v("Commenting on")]):e._e(),e.isCommentReply?t("span",{staticClass:"comment-modal__details__header"},[e._v("Replying to comments about")]):e._e(),e.isCommentEdit?t("span",{staticClass:"comment-modal__details__header"},[e._v("Editing comment on")]):e._e(),t("p",{staticClass:"comment-modal__details__framework"},[t("b",[e._v("framework: ")]),e._v(e._s(e.commentFrameworkName)+" ")]),e.isCommentOnCompetency?t("p",{staticClass:"comment-modal__details__competency"},[t("b",[e._v("competency:")]),e._v(" "+e._s(e.commentSubject.getName())+" ")]):e._e(),t("div",{staticClass:"field"},[t("div",{staticClass:"control"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.commentText,expression:"commentText"}],staticClass:"textarea",attrs:{row:"3"},domProps:{value:e.commentText},on:{input:function(t){t.target.composing||(e.commentText=t.target.value)}}})])]),e.commentIsBusy?t("div",{staticClass:"has-text-centered"},[t("span",{staticClass:"icon is-large has-text-center has-text-link"},[t("i",{staticClass:"fas fa-2x fa-spinner is-info fa-pulse"})])]):e._e()]),t("template",{slot:"modal-foot"},[t("div",{staticClass:"buttons is-spaced"},[t("button",{staticClass:"button is-dark is-outlined",on:{click:e.closeModal}},[e._v(" Cancel ")]),t("button",{staticClass:"button is-outlined is-primary",attrs:{disabled:e.commentIsBusy},on:{click:e.saveComment}},[e._v(" Save comment ")])])])],2)},r=[],a=n("c7eb"),s=n("1da1"),i=n("b85c"),c=(n("14d9"),n("498a"),n("6d79")),m=n("af07"),d={mixins:[c["a"]],name:"AddComment",components:{ModalTemplate:m["a"]},data:function(){return{commentSubject:{},commentSubjectType:"",commentText:"",loggedInPersonEcPk:{},commentToSave:{},commentIsBusy:!1}},methods:{closeModal:function(){this.$store.commit("app/closeModal")},buildNewCommentObject:function(){var e=new EcComment;return e.generateId(window.repo.selectedServer),e.setCreator(this.loggedInPerson),this.isCommentReply?e.setSubjectIds(this.commentFrameworkId,this.commentToReply.shortId()):e.setSubjectIds(this.commentFrameworkId,this.commentAboutId),e.setDateCreated(Date.now()+""),e.text=this.commentText,e.addOwner(this.loggedInPersonEcPk),this.addAllOwnersFromObjectToObject(this.commentFramework,e),this.isCommentReply&&this.addAllOwnersFromObjectToObject(this.commentToReply,e),this.isCommentOnFramework||this.addAllOwnersFromObjectToObject(this.commentSubject,e),e},buildEditCommentObject:function(){var e=this.commentToEdit;return e.text=this.commentText,e.lastEditDate=Date.now()+"",e},buildCommentObject:function(){return this.isCommentEdit?this.buildEditCommentObject():this.buildNewCommentObject()},updateStoredFrameworkCommentPersonMap:function(){var e=this.$store.getters["editor/frameworkCommentPersonMap"];e[this.loggedInPerson.shortId()]=this.loggedInPerson,this.$store.commit("editor/setFrameworkCommentPersonMap",e)},insertEditedCommentObjectIntoStoreFrameworkCommentList:function(){var e,t=[],n=this.$store.getters["editor/frameworkCommentList"],o=Object(i["a"])(n);try{for(o.s();!(e=o.n()).done;){var r=e.value;r.shortId().equals(this.commentToSave.shortId())?t.push(this.commentToSave):t.push(r)}}catch(a){o.e(a)}finally{o.f()}this.$store.commit("editor/setFrameworkCommentList",t)},updateStoreFrameworkCommentList:function(){if(this.isCommentEdit)this.insertEditedCommentObjectIntoStoreFrameworkCommentList();else{var e=this.$store.getters["editor/frameworkCommentList"];e.push(this.commentToSave),this.$store.commit("editor/setFrameworkCommentList",e)}},updateStoredFrameworkCommentData:function(){this.frameworkCommentDataAlreadyLoaded&&(this.updateStoredFrameworkCommentPersonMap(),this.updateStoreFrameworkCommentList())},saveCommentSuccess:function(){appLog("Save comment succeeded"),this.updateStoredFrameworkCommentData(),this.commentIsBusy=!1,this.closeModal(),this.$store.commit("app/showRightAside","Comments")},saveCommentFailed:function(e){this.commentIsBusy=!1,appLog("Save comment failed: "+e)},saveComment:function(){this.commentText.trim().length>0?this.loggedInPerson&&this.loggedInPerson.id?(this.loggedInPersonEcPk=this.getPersonEcPk(this.loggedInPerson),this.loggedInPersonEcPk?(this.commentIsBusy=!0,this.commentToSave=this.buildCommentObject(),appLog("commentToSave"),appLog(this.commentToSave),EcRepository.save(this.commentToSave,this.saveCommentSuccess,this.saveCommentFailed)):appLog("Could not determine person EcPk for comment")):alert("Not logged in. How did you get here?"):this.closeModal()}},computed:{commentFramework:function(){return this.$store.getters["editor/framework"]},commentFrameworkName:function(){var e=this.$store.getters["editor/framework"];return e?e.getName():"Unknown"},commentFrameworkId:function(){var e=this.$store.getters["editor/framework"];return e?e.shortId():"Unknown"},commentAboutId:function(){return this.$store.getters["editor/addCommentAboutId"]},commentType:function(){return this.$store.getters["editor/addCommentType"]},commentToEdit:function(){return this.$store.getters["editor/commentToEdit"]},commentToReply:function(){return this.$store.getters["editor/commentToReply"]},frameworkCommentDataAlreadyLoaded:function(){return this.$store.getters["editor/frameworkCommentDataLoaded"]},isCommentReply:function(){return this.commentType.equalsIgnoreCase("reply")},isCommentEdit:function(){return this.commentType.equalsIgnoreCase("edit")},isCommentNew:function(){return this.commentType.equalsIgnoreCase("new")},isCommentOnFramework:function(){return this.commentSubjectType.equalsIgnoreCase("framework")},isCommentOnCompetency:function(){return this.commentSubjectType.equalsIgnoreCase("competency")},loggedInPerson:function(){return this.$store.state.user.loggedOnPerson}},mounted:function(){var e=Object(s["a"])(Object(a["a"])().mark((function e(){var t;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.commentFrameworkId.equals(this.commentAboutId)){e.next=4;break}this.commentSubjectType="framework",e.next=9;break;case 4:return e.next=6,EcRepository.get(this.commentAboutId);case 6:t=e.sent,this.commentSubject=t,this.commentSubjectType=t.type.toLowerCase();case 9:this.isCommentEdit&&(this.commentText=this.commentToEdit.text);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},l=d,u=(n("54a0"),n("2877")),f=Object(u["a"])(l,o,r,!1,null,null,null);t["default"]=f.exports},"984b":function(e,t,n){},af07:function(e,t,n){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal cass-editor___modal",class:[{"is-active":e.active},"is-"+e.size,"cass-editor__modal--"+e.content],attrs:{id:"cass-modal"}},[t("div",{staticClass:"modal-background"}),t("div",{staticClass:"modal-card",class:"cass-editor__modal-card--"+e.size},[t("header",{staticClass:"modal-card-head is-size-4 has-text-weight-bold",class:["has-background-"+e.type,"has-text-"+e.fontColor]},[t("p",{staticClass:"modal-card-title"},[e._t("modal-header")],2),e.canClose?t("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:function(t){e.$store.commit("app/closeModal"),e.$emit("close")}}}):e._e()]),t("div",{staticClass:"modal-card-body has-text-dark"},[e._t("modal-body")],2),t("footer",{staticClass:"modal-card-foot has-background-white"},[e._t("modal-foot")],2)])])},r=[],a=(n("984b"),{name:"ModalTemplate",props:{canClose:{type:Boolean,default:!0},active:{type:Boolean,default:!1},type:{default:"primary",type:String},fontColor:{type:String,default:"white"},size:{type:String,default:"medium"},content:{defualt:"default",type:String}},data:function(){return{}},computed:{}}),s=a,i=(n("840c"),n("2877")),c=Object(i["a"])(s,o,r,!1,null,null,null);t["a"]=c.exports}}]);
//# sourceMappingURL=chunk-3561f686.2ce7bea7.js.map