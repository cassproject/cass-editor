(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-167b745b","chunk-f3b8fe20","chunk-f3b8fe20"],{"0186":function(t,e,s){"use strict";var a=s("cf96"),r=s.n(a);r.a},"4d343":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("modal-template",{attrs:{active:!0,type:"primary"},on:{close:function(e){t.closeModal,t.$emit("close")}}},[s("template",{slot:"modal-header"},[s("span",{staticClass:"title has-text-white"},[t._v("Share Assertions")])]),t.isProcessing?s("template",{slot:"modal-body"},[s("h2",{staticClass:"header has-text-centered"},[t._v(" Processing request... ")]),s("div",{staticClass:"section has-background-white has-text-centered"},[s("span",{staticClass:"icon is-large"},[s("i",{staticClass:"fa fa-spinner fa-2x fa-pulse"})])])]):t.isDone?s("template",{slot:"modal-body"},[s("div",{staticClass:"section has-background-white has-text-centered"},[s("p",[s("strong",[t._v("Success!")])])])]):s("template",{slot:"modal-body"},[s("div",{staticClass:"assertion-share-container"},[s("div",{staticClass:"assertion-share-block"},[s("h4",{staticClass:"header is-size-3"},[t._v(" Share assertions about: ")]),s("div",{staticClass:"field"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.subjectFilter,expression:"subjectFilter"}],staticClass:"input",attrs:{"data-id":"share-assertions-subject-search",type:"text",placeholder:"search for person..."},domProps:{value:t.subjectFilter},on:{input:function(e){e.target.composing||(t.subjectFilter=e.target.value)}}})]),0===t.filteredAvailableSubjects.length&&""===t.subjectFilter?s("div",[s("i",{staticClass:"fa fa-info-circle"}),t._v(" No users found ")]):t._e(),t.filteredAvailableSubjects.length>0?s("div",[s("div",{staticClass:"table-container"},[s("table",{staticClass:"table is-hoverable is-fullwidth"},[s("thead",[s("tr",[s("th",{attrs:{title:"Select"}},[s("input",{attrs:{"data-id":"share-assertions-select-all-subjects",type:"checkbox"},on:{change:t.selectAllSubjects}})]),s("th",{attrs:{title:"Add as member"}},[s("i",{staticClass:"fa fa-user"})]),s("th",{attrs:{title:"Add as manager"}},[s("i",{staticClass:"fa fa-user-shield"})])])]),s("tbody",t._l(t.filteredAvailableSubjects,(function(e,a){return s("tr",{key:a,staticStyle:{cursor:"pointer"},attrs:{"data-id":"share-assertions-subject-option"},on:{click:function(s){return t.setSubject(e.owner[0])}}},[s("td",[s("input",{attrs:{type:"checkbox"},domProps:{checked:t.shareSubjects[e.owner[0]]},on:{click:function(s){return s.stopPropagation(),t.setSubject(e.owner[0])}}})]),s("td",[t._v(" "+t._s(e.getName())+" ")]),s("td",[t._v(" "+t._s(e.email)+" ")])])})),0)])])]):t._e()]),s("div",{staticClass:"assertion-share-icon"}),s("div",{staticClass:"assertion-share-block"},[s("h4",{staticClass:"header is-size-3"},[t._v(" Send to: ")]),s("div",{staticClass:"field"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.targetFilter,expression:"targetFilter"}],staticClass:"input",attrs:{"data-id":"share-assertions-target-search",type:"text",placeholder:"search for person..."},domProps:{value:t.targetFilter},on:{input:function(e){e.target.composing||(t.targetFilter=e.target.value)}}})]),0===t.filteredAvailableTargets.length&&""===t.targetFilter?s("div",[s("i",{staticClass:"fa fa-info-circle"}),t._v(" No users found ")]):t._e(),t.filteredAvailableTargets.length>0?s("div",[s("div",{staticClass:"table-container"},[s("table",{staticClass:"table is-hoverable is-fullwidth"},[s("thead",[s("tr",[s("th",{attrs:{title:"Select"}},[s("input",{attrs:{"data-id":"share-assertions-select-all-targets",type:"checkbox"},on:{change:t.selectAllTargets}})]),s("th",{attrs:{title:"Add as member"}},[s("i",{staticClass:"fa fa-user"})]),s("th",{attrs:{title:"Add as manager"}},[s("i",{staticClass:"fa fa-user-shield"})])])]),s("tbody",t._l(t.filteredAvailableTargets,(function(e,a){return s("tr",{key:a,staticStyle:{cursor:"pointer"},attrs:{"data-id":"share-assertions-target-option"},on:{click:function(s){return t.setTarget(e.owner[0])}}},[s("td",[s("input",{attrs:{type:"checkbox"},domProps:{checked:t.shareTargets[e.owner[0]]},on:{click:function(s){return s.stopPropagation(),t.setTarget(e.owner[0])}}})]),s("td",[t._v(" "+t._s(e.getName())+" ")]),s("td",[t._v(" "+t._s(e.email)+" ")])])})),0)])])]):t._e()])]),s("div",{staticClass:"assertion-share-count-container"},[s("div",{staticClass:"assertion-share-count"},[s("strong",[t._v(t._s(Object.keys(t.shareSubjects).length)+" selected")])]),s("div",{staticClass:"assertion-share-count"},[s("strong",[t._v(t._s(Object.keys(t.shareTargets).length)+" selected")])])])]),s("template",{slot:"modal-foot"},[s("div",{staticClass:"buttons is-spaced"},[s("button",{staticClass:"button is-secondary is-outlined",attrs:{disabled:t.isProcessing},on:{click:function(e){return t.$store.commit("app/closeModal")}}},[s("span",[t._v("Cancel")]),s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-times-circle"})])]),t.isDone?s("button",{staticClass:"button is-primary is-outlined",attrs:{"data-id":"share-more-assertions-button"},on:{click:function(e){t.isDone=!1}}},[t._v(" Share More ")]):s("button",{staticClass:"button is-primary is-outlined",attrs:{"data-id":"share-assertions-button",disabled:t.isProcessing||t.notSelected},on:{click:t.shareAssertions}},[s("span",[t._v("Share")]),s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-share"})])])])])],2)},r=[],i=(s("99af"),s("4de4"),s("caad"),s("b64b"),s("ac1f"),s("2532"),s("841c"),s("54f8")),n=(s("96cf"),s("c964")),o=s("af07"),c={name:"ShareAssertionsModal",props:{isActive:Boolean},components:{ModalTemplate:o["a"]},data:function(){return{isProcessing:!1,shareSubjects:{},shareTargets:{},availablePersons:[],subjectFilter:"",targetFilter:"",isDone:!1}},computed:{filteredAvailableSubjects:function(){var t=this;return this.availablePersons.filter((function(e){return e.getName()&&e.getName().toLowerCase().indexOf(t.subjectFilter.toLowerCase())>-1||e.email&&e.email.toLowerCase().indexOf(t.subjectFilter.toLowerCase())>-1}))},filteredAvailableTargets:function(){var t=this,e=EcIdentityManager.default.ids[0].ppk.toPk().toPem();return this.availablePersons.filter((function(s){return e!==s.owner[0]&&(s.getName()&&s.getName().toLowerCase().indexOf(t.targetFilter.toLowerCase())>-1||s.email&&s.email.toLowerCase().indexOf(t.targetFilter.toLowerCase())>-1)}))},notSelected:function(){return 0===Object.keys(this.shareSubjects).length||0===Object.keys(this.shareTargets).length}},mounted:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:EcPerson.search(window.repo,"*",null,null,{size:1e4}).then((function(t){e.availablePersons=t}));case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),methods:{selectAllSubjects:function(t){var e=t.target.checked;if(e){var s,a=Object(i["a"])(this.filteredAvailableSubjects);try{for(a.s();!(s=a.n()).done;){var r=s.value;this.$set(this.shareSubjects,r.owner[0],1)}}catch(n){a.e(n)}finally{a.f()}}else this.shareSubjects={}},selectAllTargets:function(t){var e=t.target.checked;if(e){var s,a=Object(i["a"])(this.filteredAvailableTargets);try{for(a.s();!(s=a.n()).done;){var r=s.value;this.$set(this.shareTargets,r.owner[0],1)}}catch(n){a.e(n)}finally{a.f()}}else this.shareTargets={}},setSubject:function(t){this.shareSubjects[t]?this.$delete(this.shareSubjects,t):this.$set(this.shareSubjects,t,1)},setTarget:function(t){this.shareTargets[t]?this.$delete(this.shareTargets,t):this.$set(this.shareTargets,t,1)},shareAssertions:function(){var t=this;this.isProcessing=!0;for(var e="",s=Object.keys(this.shareSubjects),a=0;a<s.length;a++)e+='\\*reader:"'.concat(s[a],'"'),a!==s.length-1&&(e+=" OR ");EcAssertion.search(window.repo,'\\*owner:"'.concat(this.$store.getters["editor/getMe"],'" AND (').concat(e,")"),(function(e){var a=new EcAsyncHelper;a.each(e,(function(e,a){e.getSubjectAsync((function(r){s.includes(r.toPem())?e.getAgentAsync(function(){var s=Object(n["a"])(regeneratorRuntime.mark((function s(r){var i,n,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(t.$store.getters["editor/getMe"]!==r.toPem()){s.next=14;break}i=0,n=Object.keys(t.shareTargets);case 2:if(!(i<n.length)){s.next=9;break}return o=n[i],s.next=6,e.addReader(EcPk.fromPem(o));case 6:i++,s.next=2;break;case 9:return s.next=11,EcRepository.save(e);case 11:a(),s.next=15;break;case 14:a();case 15:case"end":return s.stop()}}),s)})));return function(t){return s.apply(this,arguments)}}(),appError):a()}),appError)}),(function(){t.isProcessing=!1,t.isDone=!0}))}),appError,{size:5e3})}},watch:{}},l=c,d=(s("0186"),s("2877")),u=Object(d["a"])(l,a,r,!1,null,null,null);e["default"]=u.exports},"984b":function(t,e,s){},a907:function(t,e,s){},ad86:function(t,e,s){"use strict";var a=s("a907"),r=s.n(a);r.a},af07:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modal cass-editor___modal",class:[{"is-active":t.active},"is-"+t.size,"cass-editor__modal--"+t.content],attrs:{id:"cass-modal"}},[s("div",{staticClass:"modal-background"}),s("div",{staticClass:"modal-card",class:"cass-editor__modal-card--"+t.size},[s("header",{staticClass:"modal-card-head is-size-4 has-text-weight-bold",class:["has-background-"+t.type,"has-text-"+t.fontColor]},[s("p",{staticClass:"modal-card-title"},[t._t("modal-header")],2),t.canClose?s("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:function(e){t.$store.commit("app/closeModal"),t.$emit("close")}}}):t._e()]),s("div",{staticClass:"modal-card-body has-text-dark"},[t._t("modal-body")],2),s("footer",{staticClass:"modal-card-foot has-background-white"},[t._t("modal-foot")],2)])])},r=[],i=(s("984b"),{name:"ModalTemplate",props:{canClose:{type:Boolean,default:!0},active:{type:Boolean,default:!1},type:{default:"primary",type:String},fontColor:{type:String,default:"white"},size:{type:String,default:"medium"},content:{defualt:"default",type:String}},data:function(){return{}},computed:{}}),n=i,o=(s("ad86"),s("2877")),c=Object(o["a"])(n,a,r,!1,null,null,null);e["a"]=c.exports},cf96:function(t,e,s){}}]);
//# sourceMappingURL=chunk-167b745b.514c5181.js.map