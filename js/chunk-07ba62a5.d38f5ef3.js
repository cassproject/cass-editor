(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07ba62a5","chunk-6b291276","chunk-62fb7533","chunk-83807946","chunk-83807946","chunk-74a95bb3"],{"00fd":function(e,t,r){var n=r("9e69d"),a=Object.prototype,s=a.hasOwnProperty,o=a.toString,i=n?n.toStringTag:void 0;function c(e){var t=s.call(e,i),r=e[i];try{e[i]=void 0;var n=!0}catch(c){}var a=o.call(e);return n&&(t?e[i]=r:delete e[i]),a}e.exports=c},1310:function(e,t){function r(e){return null!=e&&"object"==typeof e}e.exports=r},"1a8c":function(e,t){function r(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=r},"29f3":function(e,t){var r=Object.prototype,n=r.toString;function a(e){return n.call(e)}e.exports=a},"2b3e":function(e,t,r){var n=r("585a"),a="object"==typeof self&&self&&self.Object===Object&&self,s=n||a||Function("return this")();e.exports=s},"2f8b":function(e,t,r){},3729:function(e,t,r){var n=r("9e69d"),a=r("00fd"),s=r("29f3"),o="[object Null]",i="[object Undefined]",c=n?n.toStringTag:void 0;function d(e){return null==e?void 0===e?i:o:c&&c in Object(e)?a(e):s(e)}e.exports=d},"3dcd":function(e,t,r){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"columns is-multiline"},[e.selectedFramework?e._e():t("div",{staticClass:"column is-12"},[t("SearchBar",{attrs:{filterSet:"basic",ownedByMe:e.initialOwnedByMe,allowShowFrameworks:e.allowShowFrameworks,searchType:e.searchType}})],1),e.selectedFramework?e._e():t("div",{staticClass:"column is-12"},[e.$store.state.lode.competencySearchModalOpen?t("List",{attrs:{type:e.searchTypeToPassToList,view:"search",parent:e.parent,repo:e.repo,click:e.select,searchOptions:e.searchOptions,paramObj:e.paramObj,disallowEdits:!0,selectingCompetency:!0,selected:e.selectedIds,displayFirst:e.displayFirst,idsNotPermittedInSearch:e.idsNotPermittedInSearch}}):e._e()],1),e.selectedFramework&&!e.hierarchyLoaded?t("div",[e._m(0)]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.hierarchyLoaded,expression:"hierarchyLoaded"}]},[e.selectedFramework?t("Thing",{attrs:{parent:e.parent,obj:e.selectedFramework,repo:e.repo,view:e.view,expandInModal:!0}}):e._e(),e.selectedFramework?t("Hierarchy",{attrs:{parent:e.parent,container:e.selectedFramework,view:"competencySearch",containerType:"Framework",containerTypeGet:"EcFramework",containerNodeProperty:"competency",containerEdgeProperty:"relation",nodeType:"EcCompetency",edgeType:"EcAlignment",edgeRelationProperty:"relationType",edgeRelationLiteral:"narrows",edgeSourceProperty:"source",edgeTargetProperty:"target",viewOnly:!0,repo:e.repo,highlightList:null,properties:"primary"},on:{"done-loading-nodes":function(t){e.hierarchyLoaded=!0},"selected-array":e.selectedArrayEvent}}):e._e()],1)])},a=[function(){var e=this,t=e._self._c;return t("span",{staticClass:"icon is-large"},[t("i",{staticClass:"fa fa-spinner fa-2x fa-pulse"})])}],s=r("c7eb"),o=r("1da1"),i=r("5530"),c=(r("b0c0"),r("4de4"),r("d3b7"),r("caad"),r("2532"),r("159b"),r("a434"),r("14d9"),r("b64b"),r("713e")),d=r("9418"),l=r("098b"),p=r("872c"),h=r("2f62"),u=r("6b9e"),m={name:"CompetencySearch",props:{parent:{type:String,default:""},isActive:Boolean,view:{type:String,default:"modal"},idsNotPermittedInSearch:{type:Array,default:null},allowShowFrameworks:{type:Boolean,default:!1},clearFramework:{type:Boolean,default:!1},typesPermittedInSearch:{type:Array,default:null}},components:{List:c["a"],SearchBar:u["a"],Hierarchy:d["default"],Thing:l["default"]},mixins:[p["a"]],data:function(){return{repo:window.repo,selectedIds:[],displayFirst:[],sortBy:null,selectedFramework:null,hierarchyLoaded:!1}},created:function(){this.sortBy=!0===this.$store.getters["editor/conceptMode"]||!0===this.$store.getters["editor/progressionMode"]||"Concept"===this.searchType?"skos:prefLabel.keyword":"name.keyword",this.$store.commit("app/searchTerm","")},beforeDestroy:function(){this.$store.commit("app/searchTerm","")},computed:Object(i["a"])(Object(i["a"])({},Object(h["c"])({selectedCompetency:function(e){return e.editor.selectedCompetency},framework:function(e){return e.editor.framework},queryParams:function(e){return e.editor.queryParams},addingProperty:function(e){return e.lode.addingProperty}})),{},{nameOfSelectedCompetency:function(){return this.selectedCompetency&&this.selectedCompetency.name?this.selectedCompetency.getName():this.selectedCompetency?schema.Thing.getDisplayStringFrom(this.selectedCompetency["skos:prefLabel"]):""},copyOrLink:function(){return this.$store.state.lode.copyOrLink},frameworkName:function(){return this.framework?this.framework.getName():""},searchOptions:function(){var e=this,t="";if(this.queryParams&&null!=this.queryParams.filter&&(t+=" AND ("+this.queryParams.filter+")"),"DirectLink"===this.searchType&&(t+=" AND @type:Competency",this.typesPermittedInSearch&&this.typesPermittedInSearch.length>0)){t+=" AND ((dcterms\\:type:"+this.typesPermittedInSearch[0]+")";for(var r=1;r<this.typesPermittedInSearch.length;r++)t+=" OR (dcterms\\:type:"+this.typesPermittedInSearch[r]+")";t+=")"}return!0===this.$store.getters["editor/progressionMode"]&&-1!==this.addingProperty.includes("precede")&&(t+=' AND (ceasn\\:inProgressionModel:"'+this.selectedCompetency["ceasn:inProgressionModel"]+'")'),(this.showMine&&!0!==this.$store.getters["editor/conceptMode"]&&!0!==this.$store.getters["editor/progressionMode"]||this.queryParams&&(!0===this.$store.getters["editor/conceptMode"]||!0===this.$store.getters["editor/progressionMode"])&&"mine"===this.queryParams.conceptShow)&&this.currentUser&&(t+=" AND (",this.currentUser.forEach((function(r,n){0!==n&&(t+=" OR "),t+='\\*owner:"'+r.ppk.toPk().toPem()+'"',t+=' OR \\*owner:"'+e.addNewlinesToId(r.ppk.toPk().toPem())+'"'})),t+=")"),t},currentUser:function(){return EcIdentityManager.default.ids.length>0?EcIdentityManager.default.ids:void 0},initialOwnedByMe:function(){return this.$store.getters["featuresEnabled/ownedByMe"]},paramObj:function(){var e={size:20},t=this.$store.getters["app/searchTerm"];if(t&&0!==t.length)delete e.sort;else{var r="name.keyword"===this.sortBy||"skos:prefLabel.keyword"===this.sortBy?"asc":"desc",n="name.keyword"===this.sortBy||"skos:prefLabel.keyword"===this.sortBy?"text":"date";e.sort='[ { "'+this.sortBy+'": {"order" : "'+r+'" , "unmapped_type" : "'+n+'",  "missing" : "_last"}} ]'}return(this.showMine&&!0!==this.$store.getters["editor/conceptMode"]&&!0!==this.$store.getters["editor/progressionMode"]||(!0===this.$store.getters["editor/conceptMode"]||!0===this.$store.getters["editor/progressionMode"])&&"mine"===this.queryParams.conceptShow)&&(e.ownership="me"),e},searchType:function(){return this.$store.state.lode.searchType},sortResults:function(){return this.$store.getters["app/sortResults"]},showMine:function(){return this.$store.getters["app/filterByOwnedByMe"]},searchFrameworksInCompetencySearch:function(){return this.$store.getters["app/searchFrameworksInCompetencySearch"]},searchTypeToPassToList:function(){return"Competency"===this.searchType&&this.searchFrameworksInCompetencySearch?"Framework":"DirectLink"===this.searchType?"Competency":this.searchType}}),mounted:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(){var t,r;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.displayFirst.splice(0,this.displayFirst.length),this.$store.commit("app/searchTerm",""),this.copyOrLink||"Competency"!==this.searchType||!this.framework.competency){e.next=14;break}t=0;case 4:if(!(t<this.framework.competency.length)){e.next=14;break}if(this.framework.competency[t]===this.selectedCompetency.shortId()){e.next=11;break}if(this.idsNotPermittedInSearch&&0!==this.idsNotPermittedInSearch.length&&EcArray.has(this.idsNotPermittedInSearch,this.framework.competency[t])){e.next=11;break}return e.next=9,EcRepository.get(this.framework.competency[t]);case 9:r=e.sent,r&&this.displayFirst.push(r);case 11:t++,e.next=4;break;case 14:if("Level"!==this.searchType||!this.framework.level){e.next=24;break}t=0;case 16:if(!(t<this.framework.level.length)){e.next=24;break}return e.next=19,EcRepository.get(this.framework.level[t]);case 19:r=e.sent,r&&this.displayFirst.push(r);case 21:t++,e.next=16;break;case 24:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{resetModal:function(){this.$store.commit("app/closeModal"),this.selectedIds=[]},selectedArrayEvent:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t){var r,n;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.selectedIds=t,this.copyOrLink&&"Level"!==this.searchType||this.$store.commit("editor/selectedCompetenciesAsProperties",this.selectedIds),"true"!==this.queryParams.selectRelations||!this.framework.relation){e.next=12;break}r=0;case 4:if(!(r<this.framework.relation.length)){e.next=12;break}return e.next=7,EcAlignment.get(this.framework.relation[r]);case 7:n=e.sent,EcArray.has(selectedArray,n.target)&&("true"===this.queryParams.selectVerbose?t.push(JSON.parse(rld.toJson())):t.push(n.shortId()));case 9:r++,e.next=4;break;case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),select:function(e){if("Framework"===e.type)return this.selectFramework(e);EcArray.has(this.selectedIds,e.shortId())?EcArray.setRemove(this.selectedIds,e.shortId()):this.selectedIds.push(e.shortId()),this.copyOrLink&&"Level"!==this.searchType&&"DirectLink"!==this.searchType||this.$store.commit("editor/selectedCompetenciesAsProperties",this.selectedIds)},selectFramework:function(e){this.selectedFramework=e,this.$emit("selectFramework",e)},addNewlinesToId:function(e){e=e.substring(0,26)+"\n"+e.substring(26);var t=e.length,r=27;while(r+64<t)e=e.substring(0,r+64)+"\n"+e.substring(r+64),r+=65,t++;return e=e.substring(0,t-24)+"\n"+e.substring(t-24),e}},watch:{sortResults:function(){"lastEdited"===this.sortResults.id?(this.sortBy="schema:dateModified",this.displayFirst.splice(0,this.displayFirst.length)):(this.sortBy=!0===this.$store.getters["editor/conceptMode"]||!0===this.$store.getters["editor/progressionMode"]||"Concept"===this.searchType?"skos:prefLabel.keyword":"name.keyword",this.displayFirst.splice(0,this.displayFirst.length))},showMine:function(){this.showMine&&this.displayFirst.splice(0,this.displayFirst.length)},selectedIds:function(e){"search-modal"===this.parent&&this.$emit("setSelectedIds",e)},clearFramework:function(){this.clearFramework&&this.selectFramework(null)}}},f=m,y=(r("3f03"),r("2877")),w=Object(y["a"])(f,n,a,!1,null,null,null);t["a"]=w.exports},"3f03":function(e,t,r){"use strict";r("6927")},"408c":function(e,t,r){var n=r("2b3e"),a=function(){return n.Date.now()};e.exports=a},"4cef":function(e,t){var r=/\s/;function n(e){var t=e.length;while(t--&&r.test(e.charAt(t)));return t}e.exports=n},"585a":function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r("c8ba"))},6927:function(e,t,r){},"6ffa4":function(e,t,r){"use strict";r("fb6a"),r("14d9");var n=r("c7eb"),a=r("1da1"),s=r("872c");t["a"]={mixins:[s["a"]],methods:{removeObject:function(e){appLog("removing "+e.id);var t=this,r=this.$store.getters["editor/framework"],s=r.competency?r.competency.slice():null,o=r.relation?r.relation.slice():null,i=r.level?r.level.slice():null;r["schema:dateModified"]=(new Date).toISOString(),r.removeCompetency(e.shortId(),Object(a["a"])(Object(n["a"])().mark((function e(){var a;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.framework,t.$store.commit("editor/addEditsToUndo",[{operation:"update",id:a.shortId(),fieldChanged:["competency","relation","level"],initialValue:[s,o,i]}]),!0!==t.$store.state.editor.private||!0===EcEncryptedValue.encryptOnSaveMap[f.id]){e.next=6;break}return e.next=5,EcEncryptedValue.toEncryptedValue(a);case 5:a=e.sent;case 6:window.repo.saveTo(a,(function(){t.$store.commit("editor/framework",r)}),appError);case 7:case"end":return e.stop()}}),e)}))),appLog)},deleteObject:function(e){appLog("deleting "+e.id);var t=this,r=this.$store.getters["editor/framework"];if(e.shortId()===r.shortId())window.repo.deleteRegistered(r,(function(e){if(t.spitEvent("frameworkDeleted",r.shortId(),"editFrameworkSection"),null!=r.competency)for(var n=0;n<r.competency.length;n++)t.conditionalDelete(r.competency[n]);if(null!=r.relation)for(n=0;n<r.relation.length;n++)t.conditionalDelete(r.relation[n]);if(null!=r.level)for(n=0;n<r.level.length;n++)t.conditionalDelete(r.level[n]);t.$store.commit("editor/framework",null),t.importType?t.$store.commit("app/importFramework",null):t.$router.push({name:"frameworks"})}),appLog);else{var s=r.competency?r.competency.slice():null,o=r.relation?r.relation.slice():null,i=r.level?r.level.slice():null;this.$store.commit("editor/selectedCompetency",e),r["schema:dateModified"]=(new Date).toISOString(),r.removeCompetency(e.shortId(),Object(a["a"])(Object(n["a"])().mark((function a(){var c;return Object(n["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.removeLevel(e.shortId()),t.$store.commit("editor/addEditsToUndo",[{operation:"delete",obj:e},{operation:"update",id:r.shortId(),fieldChanged:["competency","relation","level"],initialValue:[s,o,i],changedValue:[r.competency,r.relation,r.level]}]),t.conditionalDelete(e.shortId()),t.spitEvent("competencyDeleted",e.shortId(),"editFrameworkSection"),t.$store.commit("editor/selectedCompetency",null),c=r,!0!==t.$store.state.editor.private||!0===EcEncryptedValue.encryptOnSaveMap[r.id]){n.next=10;break}return n.next=9,EcEncryptedValue.toEncryptedValue(r);case 9:c=n.sent;case 10:window.repo.saveTo(c,(function(){t.$store.commit("editor/framework",r)}),appError);case 11:case"end":return n.stop()}}),a)}))),appLog)}}}}},"840c":function(e,t,r){"use strict";r("2f8b")},8413:function(e,t,r){"use strict";r("f9dd")},"8d74":function(e,t,r){var n=r("4cef"),a=/^\s+/;function s(e){return e?e.slice(0,n(e)+1).replace(a,""):e}e.exports=s},"984b":function(e,t,r){},"9e69d":function(e,t,r){var n=r("2b3e"),a=n.Symbol;e.exports=a},af07:function(e,t,r){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal cass-editor___modal",class:[{"is-active":e.active},"is-"+e.size,"cass-editor__modal--"+e.content],attrs:{id:"cass-modal"}},[t("div",{staticClass:"modal-background"}),t("div",{staticClass:"modal-card",class:"cass-editor__modal-card--"+e.size},[t("header",{staticClass:"modal-card-head is-size-4 has-text-weight-bold",class:["has-background-"+e.type,"has-text-"+e.fontColor]},[t("p",{staticClass:"modal-card-title"},[e._t("modal-header")],2),e.canClose?t("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:function(t){e.$store.commit("app/closeModal"),e.$emit("close")}}}):e._e()]),t("div",{staticClass:"modal-card-body has-text-dark"},[e._t("modal-body")],2),t("footer",{staticClass:"modal-card-foot has-background-white"},[e._t("modal-foot")],2)])])},a=[],s=(r("984b"),{name:"ModalTemplate",props:{canClose:{type:Boolean,default:!0},active:{type:Boolean,default:!1},type:{default:"primary",type:String},fontColor:{type:String,default:"white"},size:{type:String,default:"medium"},content:{defualt:"default",type:String}},data:function(){return{}},computed:{}}),o=s,i=(r("840c"),r("2877")),c=Object(i["a"])(o,n,a,!1,null,null,null);t["a"]=c.exports},b047:function(e,t,r){var n=r("1a8c"),a=r("408c"),s=r("b4b0"),o="Expected a function",i=Math.max,c=Math.min;function d(e,t,r){var d,l,p,h,u,m,f=0,y=!1,w=!1,k=!0;if("function"!=typeof e)throw new TypeError(o);function g(t){var r=d,n=l;return d=l=void 0,f=t,h=e.apply(n,r),h}function b(e){return f=e,u=setTimeout(I,t),y?g(e):h}function v(e){var r=e-m,n=e-f,a=t-r;return w?c(a,p-n):a}function E(e){var r=e-m,n=e-f;return void 0===m||r>=t||r<0||w&&n>=p}function I(){var e=a();if(E(e))return x(e);u=setTimeout(I,v(e))}function x(e){return u=void 0,k&&d?g(e):(d=l=void 0,h)}function O(){void 0!==u&&clearTimeout(u),f=0,d=m=l=u=void 0}function C(){return void 0===u?h:x(a())}function S(){var e=a(),r=E(e);if(d=arguments,l=this,m=e,r){if(void 0===u)return b(m);if(w)return clearTimeout(u),u=setTimeout(I,t),g(m)}return void 0===u&&(u=setTimeout(I,t)),h}return t=s(t)||0,n(r)&&(y=!!r.leading,w="maxWait"in r,p=w?i(s(r.maxWait)||0,t):p,k="trailing"in r?!!r.trailing:k),S.cancel=O,S.flush=C,S}e.exports=d},b4b0:function(e,t,r){var n=r("8d74"),a=r("1a8c"),s=r("ffd6"),o=NaN,i=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,d=/^0o[0-7]+$/i,l=parseInt;function p(e){if("number"==typeof e)return e;if(s(e))return o;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=c.test(e);return r||d.test(e)?l(e.slice(2),r?2:8):i.test(e)?o:+e}e.exports=p},f9dd:function(e,t,r){},fbde:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("modal-template",{attrs:{content:"search",active:!0},on:{close:e.closeModal}},[t("template",{slot:"modal-header"},[t("p",{staticClass:"modal-card-title"},[t("span",{staticClass:"title has-text-white"},[e._v("Search for "+e._s(e.searchType))]),t("br"),e.copyOrLink?t("span",{staticClass:"subtitle has-text-white"},[t("b",[e._v("Editing framework:")]),e._v(" "+e._s(e.frameworkName)+" ")]):e._e()])]),t("template",{slot:"modal-body"},[e.selectedIds&&e.selectedIds.length||e.selectedFramework?t("button",{staticClass:"button is-dark is-outlined is-small is-pulled-right",on:{click:e.clickClearFramework}},[t("span",{staticClass:"icon"},[t("i",{staticClass:"fa fa-times"})]),t("span",[e._v(" Clear selection ")])]):e._e(),t("search",{ref:"search",attrs:{parent:"search-modal",allowShowFrameworks:!0,clearFramework:e.clearFramework,idsNotPermittedInSearch:e.idsNotPermittedInSearch},on:{setSelectedIds:function(t){e.selectedIds=t},selectFramework:e.selectFramework}})],1),t("template",{slot:"modal-foot"},[t("div",{staticClass:"buttons"},[t("button",{staticClass:"button is-outlined is-dark",on:{click:e.closeModal}},[t("span",{staticClass:"icon"},[t("i",{staticClass:"fa fa-times"})]),t("span",[e._v("cancel")])]),e.copyOrLink?t("button",{staticClass:"button is-outlined is-primary",attrs:{disabled:!e.selectedIds||0===e.selectedIds.length},on:{click:e.copyCompetencies}},[t("span",{staticClass:"icon"},[t("i",{staticClass:"fa fa-copy"})]),t("span",[e._v(" Copy "+e._s(e.searchType)+" ")])]):e._e(),e.copyOrLink&&e.linkEnabled?t("button",{staticClass:"button is-outlined is-primary",attrs:{disabled:!e.selectedIds||0===e.selectedIds.length},on:{click:e.appendCompetencies}},[t("span",{staticClass:"icon"},[t("i",{staticClass:"fa fa-link"})]),t("span",[e._v(" Link "+e._s(e.searchType)+" ")])]):e._e()])])],2)},a=[],s=r("c7eb"),o=r("1da1"),i=r("5530"),c=(r("99af"),r("a434"),r("14d9"),r("fb6a"),r("af07")),d=r("3dcd"),l=r("872c"),p=r("2f62"),h={name:"SearchModal",data:function(){return{selectedIds:[],clearFramework:!1,selectedFramework:null,repo:window.repo,itemsSaving:0}},components:{ModalTemplate:c["a"],Search:d["a"]},mixins:[l["a"]],computed:Object(i["a"])(Object(i["a"])({},Object(p["c"])({selectedCompetency:function(e){return e.editor.selectedCompetency},framework:function(e){return e.editor.framework},queryParams:function(e){return e.editor.queryParams},includeRelations:function(e){return e.lode.includeRelations}})),{},{copyOrLink:function(){return this.$store.state.lode.copyOrLink},searchType:function(){return this.$store.state.lode.searchType},frameworkName:function(){return this.framework&&this.framework.context?this.framework.getName():""},searchFrameworksInCompetencySearch:function(){return this.$store.getters["app/searchFrameworksInCompetencySearch"]},idsNotPermittedInSearch:function(){if(this.copyOrLink){var e=[this.framework.shortId()];return this.framework.competency&&this.framework.competency.length>0&&(e=e.concat(this.framework.competency)),e}return null},linkEnabled:function(){return"Collection"===this.framework.subType||"true"!==this.queryParams.ceasnDataFields}}),methods:{closeModal:function(){this.$store.commit("app/closeModal")},clickClearFramework:function(){var e=this;this.selectedIds.splice(0,this.selectedIds.length),this.clearFramework=!0,this.$nextTick((function(){e.clearFramework=!1}))},selectFramework:function(e){this.selectedFramework=e},addRelations:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(){var t,r;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.searchFrameworksInCompetencySearch||!this.selectedFramework.relation){e.next=10;break}t=0;case 2:if(!(t<this.selectedFramework.relation.length)){e.next=10;break}return e.next=5,EcAlignment.get(this.selectedFramework.relation[t]);case 5:r=e.sent,EcArray.has(this.selectedIds,r.target)&&EcArray.has(this.selectedIds,r.source)&&this.selectedIds.push(r.shortId());case 7:t++,e.next=2;break;case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),copyCompetencies:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(){var t,r,n,a,o,i,c,d,l,p,h,u,m,f,y,w,k,g,b,v;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.selectedIds,!this.includeRelations){e.next=4;break}return e.next=4,this.addRelations();case 4:r={},n=this.$store.state.editor.framework,a=this.framework.competency?this.framework.competency.slice():null,o=this.framework.relation?this.framework.relation.slice():null,i=this.framework.level?this.framework.level.slice():null,c=[],d=this,l=0;case 12:if(!(l<t.length)){e.next=64;break}return e.next=15,EcRepository.get(t[l]);case 15:if(p=e.sent,null==p||!p.isAny((new EcEncryptedValue).getTypes())){e.next=24;break}return h=new window["Ec"+p.encryptedType],e.t0=h,e.next=21,EcEncryptedValue.fromEncryptedValue(p);case 21:e.t1=e.sent,e.t0.copyFrom.call(e.t0,e.t1),p=h;case 24:if(null==p||!p.isAny((new EcCompetency).getTypes())){e.next=45;break}if(u=new EcCompetency,u.copyFrom(p),null!=this.queryParams.newObjectEndpoint?u.generateShortId(this.queryParams.newObjectEndpoint):u.generateId(this.repo.selectedServer),c.push(u.shortId()),u["schema:dateCreated"]=(new Date).toISOString(),u["schema:dateModified"]=(new Date).toISOString(),delete u.owner,EcIdentityManager.default.ids.length>0&&u.addOwner(EcIdentityManager.default.ids[0].ppk.toPk()),n.owner&&n.owner.length>0)for(m=0;m<n.owner.length;m++)f=n.owner[m],u.addOwner(EcPk.fromPem(f));if(n.reader&&n.reader.length>0)for(m=0;m<n.reader.length;m++)y=n.reader[m],u.addReader(EcPk.fromPem(y));if(u["ceasn:derivedFrom"]=p.id,r[p.shortId()]=u,!0!==this.$store.state.editor.private||!0===EcEncryptedValue.encryptOnSaveMap[u.id]){e.next=41;break}return e.next=40,EcEncryptedValue.toEncryptedValue(u);case 40:u=e.sent;case 41:this.itemsSaving++,function(e){Task.asyncImmediate((function(t){d.repo.saveTo(e,(function(){n.addCompetency(e.shortId()),d.$store.commit("editor/framework",n),d.afterCopy(a,o,i,c),t()}),(function(e){appError(e),d.afterCopy(a,o,i,c),t()}))}))}(u),e.next=61;break;case 45:if(null==p||!p.isAny((new EcLevel).getTypes())){e.next=61;break}if(w=new EcLevel,w.copyFrom(p),null!=this.queryParams.newObjectEndpoint?w.generateShortId(this.queryParams.newObjectEndpoint):w.generateId(this.repo.selectedServer),c.push(w.shortId()),w["schema:dateCreated"]=(new Date).toISOString(),w.competency=this.$store.state.editor.selectedCompetency.shortId(),delete w.owner,w["ceasn:derivedFrom"]=p.id,r[p.shortId()]=w,!0!==this.$store.state.editor.private||!0===EcEncryptedValue.encryptOnSaveMap[w.id]){e.next=59;break}return e.next=58,EcEncryptedValue.toEncryptedValue(w);case 58:w=e.sent;case 59:this.itemsSaving++,function(e){Task.asyncImmediate((function(t){d.repo.saveTo(e,(function(){n.addLevel(e.shortId()),d.$store.commit("editor/framework",n),d.afterCopy(a,o,i,c),t()}),(function(e){appError(e),d.afterCopy(a,o,i,c),t()}))}))}(w);case 61:l++,e.next=12;break;case 64:l=0;case 65:if(!(l<t.length)){e.next=95;break}return e.next=68,EcRepository.get(t[l]);case 68:if(p=e.sent,null==p||!p.isAny((new EcAlignment).getTypes())){e.next=92;break}if(k=r[p.target],g=r[p.source],"undefined"===typeof k||"undefined"===typeof g){e.next=92;break}if(b=new EcAlignment,b.copyFrom(p),null!=this.queryParams.newObjectEndpoint?b.generateShortId(this.queryParams.newObjectEndpoint):b.generateId(this.repo.selectedServer),c.push(b.shortId()),b["schema:dateCreated"]=(new Date).toISOString(),b.target=k.shortId(),b.source=g.shortId(),b.relationType=p.relationType,EcIdentityManager.default.ids.length>0&&b.addOwner(EcIdentityManager.default.ids[0].ppk.toPk()),n.owner&&n.owner.length>0)for(m=0;m<n.owner.length;m++)f=n.owner[m],b.addOwner(EcPk.fromPem(f));if(n.reader&&n.reader.length>0)for(m=0;m<n.reader.length;m++)y=n.reader[m],b.addReader(EcPk.fromPem(y));if(b.source===b.target){e.next=92;break}if(n["schema:dateModified"]=(new Date).toISOString(),!0!==this.$store.state.editor.private){e.next=90;break}return e.next=89,EcEncryptedValue.toEncryptedValue(b);case 89:b=e.sent;case 90:this.itemsSaving++,function(e){Task.asyncImmediate((function(t){d.repo.saveTo(e,(function(){n.addRelation(e.id),d.$store.commit("editor/framework",n),d.afterCopy(a,o,i,c),t()}),(function(e){appError(e),d.afterCopy(a,o,i,c),t()}))}))}(b);case 92:l++,e.next=65;break;case 95:v=this.$store.state.editor.selectedCompetency,l=0;case 97:if(!(l<t.length)){e.next=126;break}return e.next=100,EcRepository.get(t[l]);case 100:if(p=e.sent,null==p||!p.isAny((new EcCompetency).getTypes())){e.next=123;break}if(null==v){e.next=123;break}if(b=new EcAlignment,null!=this.queryParams.newObjectEndpoint?b.generateShortId(this.queryParams.newObjectEndpoint):b.generateId(this.repo.selectedServer),c.push(b.shortId()),b["schema:dateCreated"]=(new Date).toISOString(),g=r[p.shortId()],b.target=v.shortId(),b.source=g.shortId(),b.relationType=Relation.NARROWS,EcIdentityManager.default.ids.length>0&&b.addOwner(EcIdentityManager.default.ids[0].ppk.toPk()),n.owner&&n.owner.length>0)for(m=0;m<n.owner.length;m++)f=n.owner[m],b.addOwner(EcPk.fromPem(f));if(n.reader&&n.reader.length>0)for(m=0;m<n.reader.length;m++)y=n.reader[m],b.addReader(EcPk.fromPem(y));if(b.source===b.target){e.next=123;break}if(this.itemsSaving++,n.addRelation(b.id),n["schema:dateModified"]=(new Date).toISOString(),!0!==this.$store.state.editor.private){e.next=122;break}return e.next=121,EcEncryptedValue.toEncryptedValue(b);case 121:b=e.sent;case 122:(function(e){Task.asyncImmediate((function(t){d.repo.saveTo(e,(function(){d.afterCopy(a,o,i,c),t()}),(function(e){appError(e),d.afterCopy(a,o,i,c),t()}))}))})(b);case 123:l++,e.next=97;break;case 126:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),afterCopy:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t,r,n,a){var o,i,c;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.itemsSaving--,0!==this.itemsSaving){e.next=13;break}for(o=this.$store.state.editor.framework,i=[],c=0;c<a.length;c++)i.push({operation:"addNew",id:a[c]});if(i.push({operation:"update",id:o.shortId(),fieldChanged:["competency","relation","level"],initialValue:[t,r,n],changedValue:[o.competency,o.relation,o.level]}),this.$store.commit("editor/addEditsToUndo",i),!0!==this.$store.state.editor.private||!0===EcEncryptedValue.encryptOnSaveMap[o.id]){e.next=11;break}return e.next=10,EcEncryptedValue.toEncryptedValue(o);case 10:o=e.sent;case 11:this.repo.saveTo(o,(function(){}),appError),this.closeModal();case 13:case"end":return e.stop()}}),e,this)})));function t(t,r,n,a){return e.apply(this,arguments)}return t}(),appendCompetencies:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(){var t,r,n,a,i,c,d,l,p,h,u,m,f,y,w,k,g,b,v;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.selectedIds,!this.includeRelations){e.next=4;break}return e.next=4,this.addRelations();case 4:r=this.$store.state.editor.selectedCompetency,n=this.$store.state.editor.framework,a=this.framework.competency?this.framework.competency.slice():null,i=this.framework.relation?this.framework.relation.slice():null,c=this.framework.level?this.framework.level.slice():null,d=[],l=[],p=[],h=this,u=0;case 14:if(!(u<t.length)){e.next=30;break}return e.next=17,EcRepository.get(t[u]);case 17:if(m=e.sent,null==m||!m.isAny((new EcEncryptedValue).getTypes())){e.next=26;break}return f=new window["Ec"+m.encryptedType],e.t0=f,e.next=23,EcEncryptedValue.fromEncryptedValue(m);case 23:e.t1=e.sent,e.t0.copyFrom.call(e.t0,e.t1),m=f;case 26:m.isAny((new EcCompetency).getTypes())?n.addCompetency(m.shortId()):m.isAny((new EcLevel).getTypes())&&(n.addLevel(m.shortId()),EcArray.isArray(m.competency)||(m.competency=[m.competency]),y=m.shortId(),d.push({id:y,competency:m.competency.splice()}),m.competency.push(r.shortId()),l.push({id:y,competency:m.competency}),this.repo.saveTo(m,(function(){}),appError));case 27:u++,e.next=14;break;case 30:u=0;case 31:if(!(u<t.length)){e.next=39;break}return e.next=34,EcRepository.get(t[u]);case 34:m=e.sent,m.isAny((new EcAlignment).getTypes())&&EcArray.has(n.competency,m.source)&&EcArray.has(n.competency,m.target)&&n.addRelation(m.shortId());case 36:u++,e.next=31;break;case 39:u=0;case 40:if(!(u<t.length)){e.next=66;break}return e.next=43,EcRepository.get(t[u]);case 43:if(m=e.sent,!m.isAny((new EcCompetency).getTypes())){e.next=63;break}if(null==r){e.next=63;break}if(w=new EcAlignment,null!=this.queryParams.newObjectEndpoint?w.generateShortId(this.queryParams.newObjectEndpoint):w.generateId(this.repo.selectedServer),p.push(w.shortId()),w["schema:dateCreated"]=(new Date).toISOString(),w.target=r.shortId(),w.source=m.shortId(),w.relationType=Relation.NARROWS,EcIdentityManager.default.ids.length>0&&w.addOwner(EcIdentityManager.default.ids[0].ppk.toPk()),n.owner&&n.owner.length>0)for(k=0;k<n.owner.length;k++)g=n.owner[k],w.addOwner(EcPk.fromPem(g));if(n.reader&&n.reader.length>0)for(k=0;k<n.reader.length;k++)b=n.reader[k],w.addReader(EcPk.fromPem(b));if(w.source===w.target){e.next=63;break}if(n.addRelation(w.id),!0!==this.$store.state.editor.private){e.next=62;break}return e.next=61,EcEncryptedValue.toEncryptedValue(w);case 61:w=e.sent;case 62:this.repo.saveTo(w,(function(){}),appError);case 63:u++,e.next=40;break;case 66:for(v=[],u=0;u<p.length;u++)v.push({operation:"addNew",id:p[u]});if(d.length>0)for(u=0;u<d.length;u++)v.push({operation:"update",id:d[u].id,fieldChanged:["competency"],initialValue:[d[u].competency],changedValue:[l[u].competency]});if(v.push({operation:"update",id:n.shortId(),fieldChanged:["competency","relation","level"],initialValue:[a,i,c],changedValue:[n.competency,n.relation,n.level]}),this.$store.commit("editor/addEditsToUndo",v),!0!==this.$store.state.editor.private||!0===EcEncryptedValue.encryptOnSaveMap[n.id]){e.next=75;break}return e.next=74,EcEncryptedValue.toEncryptedValue(n);case 74:n=e.sent;case 75:this.repo.saveTo(n,Object(o["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=h.$store,e.next=3,EcFramework.get(n.id);case 3:e.t1=e.sent,e.t0.commit.call(e.t0,"editor/framework",e.t1),h.closeModal();case 6:case"end":return e.stop()}}),e)}))),appError);case 76:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},u=h,m=(r("8413"),r("2877")),f=Object(m["a"])(u,n,a,!1,null,"03a42ddd",null);t["default"]=f.exports},ffd6:function(e,t,r){var n=r("3729"),a=r("1310"),s="[object Symbol]";function o(e){return"symbol"==typeof e||a(e)&&n(e)==s}e.exports=o}}]);
//# sourceMappingURL=chunk-07ba62a5.d38f5ef3.js.map