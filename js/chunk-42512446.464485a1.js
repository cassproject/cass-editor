(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42512446"],{"791e":function(e,t,i){"use strict";var r=i("7fe2"),n=i.n(r);n.a},"7fe2":function(e,t,i){},c643:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"lode__hierarchy"},[i("div",{staticClass:"hierarchy-buttons"},[i("div",{staticClass:"columns is-gapless is-paddingless is-mobile is-marginless is-paddingless"},[i("div",{staticClass:"column is-narrow"},[e.canEdit&&"importPreview"!==e.view&&"importLight"!==e.view&&"crosswalk"!==e.view||e.queryParams.select?i("div",{staticClass:"check-radio-all-column"},[i("div",{staticClass:"field"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.selectAll,expression:"selectAll"}],staticClass:"is-checkradio",attrs:{id:"selectAllCheckbox",type:"checkbox",name:"selectAllCheckbox"},domProps:{checked:Array.isArray(e.selectAll)?e._i(e.selectAll,null)>-1:e.selectAll},on:{change:function(t){var i=e.selectAll,r=t.target,n=!!r.checked;if(Array.isArray(i)){var s=null,a=e._i(i,s);r.checked?a<0&&(e.selectAll=i.concat([s])):a>-1&&(e.selectAll=i.slice(0,a).concat(i.slice(a+1)))}else e.selectAll=n}}}),i("label",{attrs:{for:"selectAllCheckbox"}})])]):e._e()]),i("div",{staticClass:"column is-narrow"},[e.expanded?i("div",{staticClass:"icon is-vcentered",on:{click:function(t){e.expanded=!1}}},[i("i",{staticClass:"fa fa-caret-down has-text-primary is-size-2"})]):e.expanded?i("div",{staticClass:"icon is-vcentered"},[i("i",{staticClass:"fa fa-circle is-size-7 has-text-light"})]):i("div",{staticClass:"icon is-vcentered",on:{click:function(t){e.expanded=!0}}},[i("i",{staticClass:"fa fa-caret-right has-text-primary is-size-2"})]),e.selectButtonText?i("div",{staticClass:"button is-outlined is-primary",on:{click:function(t){return e.$emit("selectButtonClick",e.selectedArray)}}},[e._v(" "+e._s(e.selectButtonText)+" ")]):e._e()]),"crosswalk"===e.view?i("div",{staticClass:"crosswalk-buttons column is-fullwidth"},[i("div",{staticClass:"buttons is-right"},[i("div",{staticClass:"button is-small is-outlined is-primary",class:{"is-focused":"showAligned"===e.filter},attrs:{title:"show aligned only"},on:{click:function(t){return e.filterHierarchy("showAligned")}}},[e._m(0)]),i("div",{staticClass:"button is-small is-outlined is-primary",class:{"is-focused":"showUnaligned"===e.filter},attrs:{title:"show unaligned only"},on:{click:function(t){return e.filterHierarchy("showUnaligned")}}},[e._m(1)]),i("div",{staticClass:"button is-outlined is-small is-primary",class:{"is-focused":"showAll"===e.filter},attrs:{title:"show all"},on:{click:function(t){return e.filterHierarchy("showAll")}}},[e._m(2)]),"crosswalkSource"===e.subview&&0===e.alignmentsToSave.length?i("button",{staticClass:"button is-small is-outlined is-dark",attrs:{title:"change source"},on:{click:e.changeFrameworkSource}},[e._m(3)]):"crosswalkTarget"===e.subview&&0===e.alignmentsToSave.length?i("button",{staticClass:"button is-small is-outlined is-dark",attrs:{title:"change target"},on:{click:e.changeFrameworkTarget}},[e._m(4)]):e._e()])]):e._e(),"crosswalk"!==e.view?i("div",{staticClass:"column is-narrow"},[i("div",{staticClass:"buttons"},[e.multipleSelected&&"import"!==e.view&&e.canEdit?i("div",{staticClass:"button is-outlined is-primary",on:{click:function(t){return e.$emit("editMultipleEvent")}}},[e._m(5),i("span",[e._v(" Edit multiple ")])]):e._e(),e.addingNode||!e.canEdit||e.multipleSelected?e._e():i("div",{staticClass:"button is-outlined is-primary",on:{click:function(t){e.addingNode=!0}}},[e._m(6),i("span",[e._v(" "+e._s(e.addCompetencyOrChildText)+" ")])]),!e.addingNode&&e.canEdit&&!e.multipleSelected&&e.canCopyOrCut?i("div",{staticClass:"button is-outlined is-danger",on:{click:e.deleteSelected}},[e._m(7),i("span",[e._v(" delete item ")])]):e._e(),e.addingNode?i("div",{staticClass:"button is-outlined is-dark ",on:{click:function(t){e.addingNode=!1}}},[e._m(8),i("span",[e._v("cancel")])]):e._e(),e.addingNode?i("div",{staticClass:"button is-outlined is-primary ",on:{click:e.onClickCreateNew}},[e._m(9),i("span",[e._v(" create new ")])]):e._e(),e.addingNode?i("div",{staticClass:"button is-outlined is-primary ",on:{click:e.clickToSearch}},[e._m(10),i("span",[e._v("search competencies")])]):e._e(),"framework"===e.view||"concept"===e.view?i("div",{staticClass:"button is-outlined",class:e.canCopyOrCut?"is-primary":"is-disabled",attrs:{disabled:!e.canCopyOrCut,title:"Copy competency"},on:{click:e.copyClick}},[e._m(11)]):e._e(),"framework"===e.view||"concept"===e.view?i("div",{staticClass:"button is-outlined",class:e.canCopyOrCut?"is-primary":"is-disabled",attrs:{title:"Cut competency",disabled:!e.canCopyOrCut},on:{click:e.cutClick}},[e._m(12)]):e._e(),"framework"===e.view||"concept"===e.view?i("div",{staticClass:"button is-outlined ",class:e.canPaste?"is-primary":"is-disabled",attrs:{disabled:!e.canPaste,title:"Paste competency"},on:{click:e.pasteClick}},[e._m(13)]):e._e(),"framework"===e.view||"concept"===e.view?i("div",{staticClass:"button is-outlined ",class:e.clipboardContainsItem?"is-danger":"is-disabled",attrs:{disabled:!e.clipboardContainsItem,title:"Clear clipboard"},on:{click:e.clearClipboard}},[e._m(14)]):e._e()])]):e._e(),"importPreview"===e.view||"importLight"===e.view?i("div",{staticClass:"column"},[i("div",{staticClass:"buttons is-right"},[i("div",{staticClass:"buttons is-small is-right"},[i("div",{staticClass:" button is-light is-small is-pulled-right is-dark is-outlined",on:{click:e.cancelImport}},[i("span",[e._v(" Cancel ")]),e._m(15)]),"importLight"===e.view&&("text"!==e.importType||"text"===e.importType&&"Competency detected"===e.importStatus)?i("div",{staticClass:"button is-small is-dark is-outlined is-pulled-right",on:{click:function(t){return e.showModal("export")}}},[i("span",[e._v(" Export ")]),e._m(16)]):e._e(),"importLight"===e.view&&("text"!==e.importType||"text"===e.importType&&"Competency detected"===e.importStatus)?i("div",{staticClass:"button is-small is-dark is-outlined is-pulled-right",on:{click:function(t){return e.$store.dispatch("app/clearImport")}}},[i("span",[e._v(" import again ")]),e._m(17)]):e._e(),"importLight"===e.view&&("text"!==e.importType||"text"===e.importType&&"Competency detected"===e.importStatus)?i("div",{staticClass:"button is-small is-dark is-outlined is-pulled-right",on:{click:e.openFramework}},[i("span",[e._v("view in editor")]),e._m(18)]):e._e(),"importPreview"===e.view?i("div",{staticClass:"button  is-small is-primary is-outlined is-pulled-right",on:{click:function(t){return e.$store.commit("app/importTransition","light")}}},[i("span",[e._v(" done editing ")]),e._m(19)]):e._e(),"importLight"===e.view&&("text"!==e.importType||"text"===e.importType&&"Competency detected"===e.importStatus)?i("router-link",{staticClass:"button is-small is-primary is-outlined is -pulled-right",attrs:{to:"/"}},[i("span",[e._v(" Done ")]),i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-home"})])]):e._e()],1)])]):e._e()])]),e.hierarchy?[i("draggable",e._b({staticClass:"lode__hierarchy-ul",attrs:{tag:"ul",disabled:!0!==e.canEdit||!e.isDraggable,group:{name:"test"},handle:".handle"},on:{start:e.beginDrag,end:e.endDrag},model:{value:e.hierarchy,callback:function(t){e.hierarchy=t},expression:"hierarchy"}},"draggable",e.dragOptions,!1),e._l(e.hierarchy,(function(t,r){return i("HierarchyNode",{key:t.obj.id,staticClass:"lode__hierarchy-li",attrs:{view:e.view,subview:e.subview,obj:t.obj,dragging:e.dragging,canEdit:e.canEdit,hasChild:t.children,profile:e.profile,exportOptions:e.exportOptions,highlightList:e.highlightList,selectAll:e.selectAll,newFramework:e.newFramework,index:r,parentStructure:e.hierarchy,parent:e.container,frameworkEditable:e.canEdit,filter:e.filter,selectedArray:e.selectedArray,properties:e.properties,expandAll:1==e.expanded,parentChecked:!1,shiftKey:e.shiftKey,arrowKey:e.arrowKey},on:{createNewNodeEvent:e.onCreateNewNode,mountingNode:e.handleMountingNode,beginDrag:e.beginDrag,move:e.move,select:e.select,add:e.add,deleteObject:e.deleteObject,removeObject:e.removeObject,exportObject:e.exportObject,draggableCheck:e.onDraggableCheck}})})),1)]:e._e()],2)},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-link"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-unlink"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-list-alt"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-exchange-alt"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-exchange-alt"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-cog"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-plus-circle"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-plus-circle"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-times"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-plus"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-search"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-copy"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fas handle fa-cut"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-paste"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fas fa-clipboard"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-times-circle"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-download"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-redo-alt"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-edit"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"icon"},[i("i",{staticClass:"fa fa-arrow-right"})])}],s=(i("99af"),i("4de4"),i("c975"),i("fb6a"),i("a434"),i("b0c0"),i("d3b7"),i("ddb0"),i("1f27")),a=i("872c"),o=(i("21a6"),{name:"Hierarchy",mixins:[s["a"],a["a"]],props:{container:Object,containerType:String,containerTypeGet:String,containerNodeProperty:String,containerEdgeProperty:String,nodeType:String,edgeType:String,edgeRelationProperty:String,edgeSourceProperty:String,edgeTargetProperty:String,edgeRelationLiteral:String,viewOnly:Boolean,repo:Object,profile:Object,exportOptions:Array,highlightList:Array,newFramework:Boolean,properties:String,view:{type:String,default:"framework"},subview:{type:String,default:""}},data:function(){return{filter:"showAll",dragIcon:"fa-arrows-alt",dragOptions:{delay:0,scroll:!0,disabled:!1,emptyInsertThreshold:5,swapThreshold:.25,invertSwap:!0,invertedSwapThreshold:.25,animation:0,ghostClass:"ghost-drag",chosenClass:"chosen-drag",dragClass:"drag",scrollSensitivity:30,scrollSpeed:5,forceFallback:!0},multipleSelected:!1,addingNode:!1,structure:[],once:!0,dragging:!1,controlOnStart:!1,selectAll:!1,selectedArray:[],selectButtonText:null,expanded:!0,showAligned:!1,isDraggable:!0,frameworkExportOptions:[{name:"Achievement Standards Network (RDF+JSON)",value:"asn"},{name:"CASS (JSON-LD)",value:"jsonld"},{name:"CASS (RDF Quads)",value:"rdfQuads"},{name:"CASS (RDF+JSON)",value:"rdfJson"},{name:"CASS (RDF+XML)",value:"rdfXml"},{name:"CASS (Turtle)",value:"turtle"},{name:"Credential Engine ASN (JSON-LD)",value:"ctdlasnJsonld"},{name:"Credential Engine ASN (CSV)",value:"ctdlasnCsv"},{name:"Table (CSV)",value:"csv"},{name:"IMS Global CASE (JSON)",value:"case"}],shiftKey:!1,arrowKey:null,addCompetencyOrChildText:"Add Competency"}},components:{HierarchyNode:function(){return i.e("chunk-6a14e7d0").then(i.bind(null,"8461"))},draggable:function(){return i.e("chunk-4a49d1f9").then(i.t.bind(null,"310e",7))}},watch:{container:{handler:function(){this.once=!0},deep:!0},selectedArray:function(){this.selectedArray.length>1?this.multipleSelected=!0:this.multipleSelected=!1,1===this.selectedArray.length?this.addCompetencyOrChildText="Add Child":this.addCompetencyOrChildText="Add Competency",this.$emit("selectedArray",this.selectedArray)}},computed:{canCopyOrCut:function(){return!(!this.selectedArray||1!==this.selectedArray.length)},clipboardContainsItem:function(){return null!==this.$store.getters["editor/copyId"]||null!==this.$store.getters["editor/cutId"]},canPaste:function(){return(null!==this.$store.getters["editor/copyId"]||null!==this.$store.getters["editor/cutId"])&&null!==this.$store.getters["editor/nodeInFocus"]},alignmentsToSave:function(){return this.$store.getters["crosswalk/alignmentsToSave"]?this.$store.getters["crosswalk/alignmentsToSave"]:[]},showAddComments:function(){return"true"!==this.$store.getters["editor/queryParams"].concepts&&this.$store.state.app.canAddComments},importType:function(){return this.$store.getters["app/importType"]},importStatus:function(){return this.$store.getters["app/importStatus"]},importTransition:function(){return this.$store.getters["app/importTransition"]},queryParams:function(){return this.$store.getters["editor/queryParams"]},hierarchy:function(){var e=this;if(null==this.container)return null;if(!this.once)return this.structure;appLog("Computing hierarchy.");var t=[];return null!=this.container[this.containerNodeProperty]&&(t=t.concat(this.container[this.containerNodeProperty])),null!=this.container[this.containerEdgeProperty]&&(t=t.concat(this.container[this.containerEdgeProperty])),t.length>0?this.repo.multiget(t,(function(t){e.computeHierarchy()}),appError,appLog):e.computeHierarchy(),this.structure},canEdit:function(){return!0!==this.viewOnly&&this.container.canEditAny(EcIdentityManager.getMyPks())}},mounted:function(){this.queryParams&&(this.queryParams.singleSelect&&(this.selectButtonText=this.queryParams.singleSelect),this.queryParams.select&&""!==this.queryParams.select&&"select"!==this.queryParams.select&&(this.selectButtonText=this.queryParams.select)),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)},beforeDestroy:function(){window.removeEventListener("keyup",this.keyup),window.removeEventListener("keydown",this.keydown)},methods:{clearClipboard:function(){this.$store.commit("editor/copyId",null),this.$store.commit("editor/cutId",null),this.$store.commit("editor/paste",!1)},cutClick:function(){this.selectedArray&&1===this.selectedArray.length&&this.$store.commit("editor/cutId",this.selectedArray[0]),this.$store.commit("editor/copyId",null),this.$store.commit("editor/paste",!1)},copyClick:function(){this.selectedArray&&1===this.selectedArray.length&&this.$store.commit("editor/copyId",this.selectedArray[0]),this.$store.commit("editor/cutId",null),this.$store.commit("editor/paste",!1)},pasteClick:function(){this.$store.commit("editor/paste",!0)},keydown:function(e){this.canEdit&&(e.shiftKey&&(this.shiftKey=!0),-1!==e.key.indexOf("Arrow")&&e.shiftKey&&(this.arrowKey=e.key),"x"===e.key&&e.ctrlKey&&(this.selectedArray&&1===this.selectedArray.length&&this.$store.commit("editor/cutId",this.selectedArray[0]),this.$store.commit("editor/copyId",null),this.$store.commit("editor/paste",!1)),"c"===e.key&&e.ctrlKey&&(this.selectedArray&&1===this.selectedArray.length&&this.$store.commit("editor/copyId",this.selectedArray[0]),this.$store.commit("editor/cutId",null),this.$store.commit("editor/paste",!1)),"v"===e.key&&e.ctrlKey&&this.$store.commit("editor/paste",!0)),-1===e.key.indexOf("Arrow")||e.shiftKey||("ArrowLeft"===e.key?this.expanded=!1:"ArrowRight"===e.key&&(this.expanded=!0))},keyup:function(e){e.shiftKey||(this.shiftKey=!1),-1!==e.key.indexOf("Arrow")&&(this.arrowKey=null)},showModal:function(e,t){var i=this,r={};"export"===e&&(r={type:e,selectedExportOption:"",title:"Export framework",exportOptions:this.frameworkExportOptions,text:"Select a file format to export your framework. Files download locally.",onConfirm:function(e){return i.exportObject(e)}}),this.$modal.show(r)},openFramework:function(){var e=EcFramework.getBlocking(this.container.shortId());this.$store.commit("editor/framework",e),this.$router.push({name:"framework",params:{frameworkId:this.container.id}})},changeFrameworkTarget:function(){this.$store.commit("crosswalk/step",1)},changeFrameworkSource:function(){this.$store.commit("crosswalk/step",0)},filterHierarchy:function(e){this.filter=e},onCreateNewNode:function(e,t){this.add(e,t)},handleMountingNode:function(){this.startTime()},startTime:function(){var e=this;setTimeout((function(){e.$emit("doneLoadingNodes")}),1e3)},computeHierarchy:function(){var e=this,t={},i={};if(this.structure=[],null==this.container)return t;if(null!==this.container[this.containerNodeProperty]&&void 0!==this.container[this.containerNodeProperty])for(var r=0;r<this.container[this.containerNodeProperty].length;r++){var n=window[this.nodeType].getBlocking(this.container[this.containerNodeProperty][r]);null!==n&&(t[this.container[this.containerNodeProperty][r]]=t[n.shortId()]=i[n.shortId()]=n)}if(null!=this.container[this.containerEdgeProperty]&&void 0!==this.container[this.containerEdgeProperty])for(r=0;r<this.container[this.containerEdgeProperty].length;r++){var s=null;if(s=window[this.edgeType].getBlocking(this.container[this.containerEdgeProperty][r]),null!=s){if(s[this.edgeRelationProperty]===this.edgeRelationLiteral){if(null==t[s[this.edgeTargetProperty]])continue;if(null==t[s[this.edgeSourceProperty]])continue;null==t[s[this.edgeTargetProperty]]._children&&(t[s[this.edgeTargetProperty]]._children=[]),t[s[this.edgeTargetProperty]]._children.push(t[s[this.edgeSourceProperty]]),delete i[s[this.edgeSourceProperty]]}}else appLog("Hierarchy: Could not find edge: "+this.container[this.containerEdgeProperty][r])}if(null!=this.container[this.containerNodeProperty])for(r=0;r<this.container[this.containerNodeProperty].length;r++)t[this.container[this.containerNodeProperty][r]]&&null!=t[this.container[this.containerNodeProperty][r]]._children&&t[this.container[this.containerNodeProperty][r]]._children.sort((function(t,i){return e.container[e.containerNodeProperty].indexOf(t.shortId())-e.container[e.containerNodeProperty].indexOf(i.shortId())}));this.structure.splice(0,this.structure.length);var a=EcObject.keys(i);for(r=0;r<a.length;r++)this.structure.push(i[a[r]]);this.structure.sort((function(t,i){return e.container[e.containerNodeProperty].indexOf(t.shortId())-e.container[e.containerNodeProperty].indexOf(i.shortId())})),this.packChildren(this.structure),this.deleteUnderscore(this.structure),this.once=!1},packChildren:function(e){if(null!=e){for(var t=0;t<e.length;t++)e[t].obj||(e[t]={obj:e[t],children:void 0===e[t]._children?[]:e[t]._children});for(t=0;t<e.length;t++)this.packChildren(e[t].children)}},deleteUnderscore:function(e){if(null!=e)for(var t=0;t<e.length;t++)delete e[t].obj._children,this.deleteUnderscore(e[t].children)},beginDrag:function(e){this.dragging=!0,void 0!==e&&(this.controlOnStart=e.originalEvent.ctrlKey||e.originalEvent.shiftKey)},endDrag:function(e){if("framework_drag"!==e.to.id){appLog(e.oldIndex,e.newIndex);var t=null,i=0;this.shiftKey&&(this.controlOnStart=!0),e.from.id===e.to.id?(e.newIndex<this.hierarchy.length&&(t=this.hierarchy[e.newIndex].obj.shortId()),i=1):void 0===e.to.children[e.newIndex]?t=e.to.id:e.newIndex+1<e.to.children.length&&(t=e.to.children[e.newIndex+1].id),this.move(this.hierarchy[e.oldIndex].obj.shortId(),t,e.from.id,e.to.id,!this.controlOnStart,i)}else this.dragging=!1},move:function(e,t,i,r,n,s){this.once=!0;var a=this,o=a.container[a.containerNodeProperty]?a.container[a.containerNodeProperty].slice():null,c=a.container[a.containerEdgeProperty]?a.container[a.containerEdgeProperty].slice():null,l=[];if(EcArray.isArray(a.container[a.containerEdgeProperty])||(a.container[a.containerEdgeProperty]=[]),e!==t){var d=this.container[this.containerNodeProperty].indexOf(e);appLog(d),this.container[this.containerNodeProperty].splice(d,1);var h=null;h=null==t||void 0===t?-1:this.container[this.containerNodeProperty].indexOf(t),appLog(h),s>0&&d<=h&&(h+=s),s<0&&d<h&&(h+=s),-1===h?this.container[this.containerNodeProperty].push(e):this.container[this.containerNodeProperty].splice(h,0,e)}if(i!==r){var p=window[this.nodeType].getBlocking(e),u=window[this.nodeType].getBlocking(r);if(!0===n&&e!==r)for(var m=0;m<this.container[this.containerEdgeProperty].length;m++){var y=window[this.edgeType].getBlocking(this.container[this.containerEdgeProperty][m]);if(null!=y&&y[this.edgeRelationProperty]===this.edgeRelationLiteral){if(null==y[this.edgeTargetProperty])continue;if(null==y[this.edgeSourceProperty])continue;if(y[this.edgeSourceProperty]!==e)continue;appLog("Identified edge to remove: ",JSON.parse(y.toJson())),this.container[this.containerEdgeProperty].splice(m--,1)}}if(null!=r&&""!==r){y=new window[this.edgeType];if(null!=EcIdentityManager.ids&&EcIdentityManager.ids.length>0&&y.addOwner(EcIdentityManager.ids[0].ppk.toPk()),this.container.owner&&this.container.owner.length>0)for(var g=0;g<this.container.owner.length;g++){var f=this.container.owner[g];y.addOwner(EcPk.fromPem(f))}if(this.container.reader&&this.container.reader.length>0)for(g=0;g<this.container.reader.length;g++){var v=this.container.reader[g];y.addReader(EcPk.fromPem(v))}null!=u&&void 0!==u&&p.shortId()!==u.shortId()&&(a.queryParams&&a.queryParams.newObjectEndpoint?y.generateShortId(this.queryParams.newObjectEndpoint):y.assignId(a.repo.selectedServer,EcCrypto.md5(p.shortId())+"_"+this.edgeRelationLiteral+"_"+EcCrypto.md5(u.shortId())),y.source=p.shortId(),y.target=u.shortId(),y.relationType=this.edgeRelationLiteral,this.container[this.containerEdgeProperty].push(y.shortId()),l.push(y.shortId()),appLog("Added edge: ",JSON.parse(y.toJson())),this.$store.state.editor&&!0===this.$store.state.editor.private&&(y=EcEncryptedValue.toEncryptedValue(y)),this.repo.saveTo(y,appLog,appError))}}var w=this.stripEmptyArrays(this.container),C=[];for(m=0;m<l.length;m++)C.push({operation:"addNew",id:l[m]});C.push({operation:"update",id:a.container.shortId(),fieldChanged:["competency","relation"],initialValue:[o,c],changedValue:[this.container.competency,this.container.relation]}),a.$store.commit("editor/addEditsToUndo",C),w["schema:dateModified"]=(new Date).toISOString(),this.$store.state.editor&&!0===this.$store.state.editor.private&&!0!==EcEncryptedValue.encryptOnSaveMap[w.id]&&(w=EcEncryptedValue.toEncryptedValue(w)),this.repo.saveTo(w,appLog,appError),this.dragging=!1},add:function(e,t){var i=this,r=new window[this.nodeType],n=this.container.competency?this.container.competency.slice():null,s=this.container.relation?this.container.relation.slice():null;if(this.queryParams&&null!=this.queryParams.newObjectEndpoint?r.generateShortId(this.queryParams.newObjectEndpoint):r.generateId(this.repo.selectedServer),null!=EcIdentityManager.ids&&EcIdentityManager.ids.length>0&&r.addOwner(EcIdentityManager.ids[0].ppk.toPk()),this.container.owner&&this.container.owner.length>0)for(var a=0;a<this.container.owner.length;a++){var o=this.container.owner[a];r.addOwner(EcPk.fromPem(o))}if(this.container.reader&&this.container.reader.length>0)for(a=0;a<this.container.reader.length;a++){var c=this.container.reader[a];r.addReader(EcPk.fromPem(c))}if(EcArray.isArray(i.container[i.containerNodeProperty])||(i.container[i.containerNodeProperty]=[]),null==t||void 0===t)this.container[this.containerNodeProperty].push(r.shortId());else{var l=this.container[this.containerNodeProperty].indexOf(t);this.container[this.containerNodeProperty].splice(l+1,0,r.shortId())}i.$store.commit("editor/addEditsToUndo",[{operation:"addNew",id:r.shortId()},{operation:"update",id:i.container.shortId(),fieldChanged:["competency"],initialValue:[n],changedValue:[this.container.competency]}]);var d=this.nodeType;0===this.nodeType.indexOf("Ec")&&(d=this.nodeType.substring(2)),this.$store.state.editor&&this.$store.state.editor.defaultLanguage?r.name={"@language":this.$store.state.editor.defaultLanguage,"@value":"New "+d}:r.name="New "+d,r["schema:dateCreated"]=(new Date).toISOString(),r["schema:dateModified"]=(new Date).toISOString(),this.container["schema:dateModified"]=(new Date).toISOString(),appLog("Added node: ",JSON.parse(r.toJson())),this.$store.state.editor&&this.$store.commit("editor/newCompetency",r.shortId()),this.$store.state.editor&&!0===this.$store.state.editor.private&&(r=EcEncryptedValue.toEncryptedValue(r)),this.repo.saveTo(r,(function(){if(e===i.container.shortId()){var t=i.container;t["schema:dateModified"]=(new Date).toISOString(),i.$store.state.editor&&!0===i.$store.state.editor.private&&!0!==EcEncryptedValue.encryptOnSaveMap[i.container.id]&&(t=EcEncryptedValue.toEncryptedValue(i.container)),i.repo.saveTo(i.stripEmptyArrays(t),(function(){i.once=!0}),appError)}else{var a=new window[i.edgeType];if(null!=EcIdentityManager.ids&&EcIdentityManager.ids.length>0&&a.addOwner(EcIdentityManager.ids[0].ppk.toPk()),i.container.owner&&i.container.owner.length>0)for(var o=0;o<i.container.owner.length;o++){var c=i.container.owner[o];a.addOwner(EcPk.fromPem(c))}if(i.container.reader&&i.container.reader.length>0)for(o=0;o<i.container.reader.length;o++){var l=i.container.reader[o];a.addReader(EcPk.fromPem(l))}if(i.queryParams&&i.queryParams.newObjectEndpoint?a.generateShortId(i.queryParams.newObjectEndpoint):a.assignId(i.repo.selectedServer,EcCrypto.md5(r.shortId())+"_"+i.edgeRelationLiteral+"_"+EcCrypto.md5(e)),a.source=r.shortId(),a.target=e,a.source!==a.target){a.relationType=i.edgeRelationLiteral,EcArray.isArray(i.container[i.containerEdgeProperty])||(i.container[i.containerEdgeProperty]=[]),i.container[i.containerEdgeProperty].push(a.shortId()),appLog("Added edge: ",JSON.parse(a.toJson())),i.$store.commit("editor/addEditsToUndo",[{operation:"addNew",id:r.shortId()},{operation:"update",id:i.container.shortId(),fieldChanged:["competency","relation"],initialValue:[n,s],changedValue:[i.container.competency,i.container.relation]}]);t=i.container;t["schema:dateModified"]=(new Date).toISOString(),i.$store.state.editor&&!0===i.$store.state.editor.private&&(a=EcEncryptedValue.toEncryptedValue(a),!0!==EcEncryptedValue.encryptOnSaveMap[i.container.id]&&(t=EcEncryptedValue.toEncryptedValue(i.container))),i.repo.saveTo(a,(function(){i.repo.saveTo(i.stripEmptyArrays(t),(function(){i.once=!0}),appError)}),appError)}}}),appError)},stripEmptyArrays:function(e){if(EcArray.isArray(e)){if(0===e.length)return null;for(var t=0;t<e.length;t++)e[t]=this.stripEmptyArrays(e[t]),null==e[t]&&e.splice(t--,1)}else if(EcObject.isObject(e))for(var i in e){var r=this.stripEmptyArrays(e[i]);null==r&&delete e[i]}return e},select:function(e,t){t?EcArray.setAdd(this.selectedArray,e):EcArray.setRemove(this.selectedArray,e)},deleteObject:function(e){this.$emit("deleteObject",e)},removeObject:function(e){this.$emit("removeObject",e)},exportObject:function(e,t){this.$emit("exportObject",e,t)},onDraggableCheck:function(e){this.isDraggable=e},clickToSearch:function(){this.$store.commit("editor/selectedCompetency",null);var e={selectedCompetency:null,searchType:"Competency",copyOrLink:!0,component:"Search"};this.$emit("searchThings",e),this.$store.commit("lode/competencySearchModalOpen",!0),this.$store.commit("lode/searchType","Competency"),this.$store.commit("lode/copyOrLink",!0)},cancelImport:function(){this.deleteObject(this.container),this.$store.dispatch("app/clearImport")},onClickCreateNew:function(){var e=this.container.shortId();1===this.selectedArray.length&&(e=this.selectedArray[0]),this.add(e,null),this.addingNode=!1},deleteSelected:function(){var e=EcRepository.getBlocking(this.selectedArray[0]);this.deleteObject(e),this.selectedArray.splice(0,this.selectedArray.length)}}}),c=o,l=(i("791e"),i("2877")),d=Object(l["a"])(c,r,n,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-42512446.464485a1.js.map